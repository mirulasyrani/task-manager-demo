<div class="page-header"><h1 class="page-title">{{ isEdit ? 'Edit Task' : 'New Task' }}</h1></div>
<div class="card form-card">
  <div *ngIf="loading" style="text-align:center;padding:1.5rem;color:var(--muted)">Loading…</div>
  <form *ngIf="!loading" (ngSubmit)="save()" novalidate>
    <div *ngIf="error" class="invalid-feedback" style="margin-bottom:1rem">{{ error }}</div>
    <div class="form-group">
      <label>Title <span style="color:var(--danger)">*</span></label>
      <input class="form-control" type="text" [(ngModel)]="task.title" name="title" placeholder="e.g. Implement login endpoint" required maxlength="200">
    </div>
    <div class="form-group">
      <label>Description</label>
      <textarea class="form-control" rows="4" [(ngModel)]="task.description" name="description" placeholder="Optional task details…" maxlength="1000"></textarea>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem">
      <div class="form-group"><label>Status</label>
        <select class="form-control" [(ngModel)]="task.status" name="status"><option *ngFor="let s of statuses" [value]="s.value">{{ s.label }}</option></select>
      </div>
      <div class="form-group"><label>Priority</label>
        <select class="form-control" [(ngModel)]="task.priority" name="priority"><option *ngFor="let p of priorities" [value]="p.value">{{ p.label }}</option></select>
      </div>
    </div>
    <div class="form-group"><label>Category</label>
      <select class="form-control" [(ngModel)]="selectedCategoryId" name="category"><option value="">— None —</option><option *ngFor="let c of categories" [value]="c.id">{{ c.name }}</option></select>
    </div>
    <div class="form-actions">
      <button type="button" class="btn btn-secondary" (click)="cancel()">Cancel</button>
      <button type="submit" class="btn btn-primary" [disabled]="saving">{{ saving ? 'Saving…' : (isEdit ? 'Update Task' : 'Create Task') }}</button>
    </div>
  </form>
</div>
